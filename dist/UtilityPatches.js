function C(o){window.enmity.plugins.registerPlugin(o)}const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList,e.Image,e.ImageBackground,e.KeyboardAvoidingView,e.Modal,e.Pressable,e.RefreshControl;const I=e.ScrollView;e.SectionList,e.StatusBar,e.StyleSheet,e.Switch,e.Text,e.TextInput,e.TouchableHighlight,e.TouchableOpacity,e.TouchableWithoutFeedback,e.Touchable;const N=e.View;e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox;const R=e.FormDivider;e.FormHint,e.FormIcon;const E=e.FormInput;e.FormLabel,e.FormRadio;const F=e.FormRow,P=e.FormSection;e.FormSelect,e.FormSubLabel;const M=e.FormSwitch;e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;const D=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const m=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings;const L=window.enmity.modules.common.Users;window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack;const S=window.enmity.modules.common.Theme;window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function k(o,t){return window.enmity.modules.getModule(o,t)}function g(...o){return window.enmity.modules.getByProps(...o)}function h(...o){return window.enmity.modules.getByName(...o)}window.enmity.modules.common;var A="UtilityPatches",B="1.1.5",V="Minor patches/fixes all bundled into a single plugin for convenience.",O="#ff0069",U=[{name:"Rosie<3",id:"581573474296791211"}],l={name:A,version:B,description:V,color:O,authors:U};function f(o,t,n){window.enmity.settings.set(o,t,n)}function d(o,t,n){return window.enmity.settings.get(o,t,n)}const u=o=>d(l.name,"settings",{})[o],T=(o,t)=>f(l.name,"settings",{...d(l.name,"settings",{}),[o]:t}),v={roleDot:{title:"Add Role Dots",subtitle:"Force-enables role-dots aswell as role-colors disregarding your accessibility settings.",icon:"ic_members"},headerPrimary:{title:"Fix Text Labels",subtitle:"Forces all Text Labels use the 'text-normal' color instead of the default 'header-primary'.",icon:"ic_add_text"},pronouns:{title:"Early Pronouns",subtitle:()=>`Set your own pronouns to ${d(l.name,"pronouns","unspecified")}. Keep in mind others will not be able to see this.`,icon:"ic_accessibility_24px",custom:o=>m.createElement(E,{placeholder:"Your pronouns go here",title:"Pronouns",value:d(l.name,"pronouns","unspecified"),onChange:t=>f(l.name,"pronouns",t),disabled:o,style:{marginTop:-16}})},mediaItems:{title:"Media Items",subtitle:()=>`Changes the amount of media items per row in media picker to '${d(l.name,"mediaItemsNumber",2)}' instead of the default '3'.`,icon:"ic_image",custom:o=>{const t=k(c=>c.render.name==="SliderComponent"),n=h("FormLabel"),{meta:{resolveSemanticColor:i}}=g("colors","meta"),{ThemeColorMap:{HEADER_PRIMARY:a,BACKGROUND_PRIMARY:y}}=D,r=c=>m.createElement(n,{text:c,style:{marginHorizontal:24,opacity:o?.5:1}}),s=1,p=8;return m.createElement(N,{style:{alignItems:"center",flexDirection:"row"}},r(s),m.createElement(t,{value:d(l.name,"mediaItemsNumber",2),minimumValue:s,maximumValue:p,style:{flex:1},minimumTrackTintColor:i(S.theme,a),maximumTrackTintColor:i(S.theme,y),step:1,onValueChange:c=>f(l.name,"mediaItemsNumber",c),key:"media-items-number",disabled:o,tapToSeek:!0}),r(p))}},jsonFix:{title:"Upload JSON Files",subtitle:"Fixes a long-lasting bug of Discord where JSON files couldn't be uploaded and sent properly.",icon:"icon-qs-files"}},_=o=>{d(l.name,"settings",{})[o]===void 0&&T(o,!0)};function j(o){return window.enmity.assets.getIDByName(o)}var $=()=>m.createElement(I,null,m.createElement(P,{title:"Preferences"},Object.entries(v).map(([o,t],n,i)=>{var a,y;const{title:r,subtitle:s,icon:p,custom:c}=t,b=!((a=u(o))==null||a);return m.createElement(m.Fragment,null,m.createElement(F,{label:r,subLabel:typeof s=="function"?s==null?void 0:s():s,leading:p&&m.createElement(F.Icon,{source:j(p)}),trailing:()=>m.createElement(M,{value:u(o),onValueChange:x=>T(o,x)}),disabled:b}),(y=c==null?void 0:c(b))!=null?y:m.createElement(m.Fragment,null),n<i.length-1&&m.createElement(R,null))})));function H(o){return window.enmity.patcher.create(o)}function J(o,t,n){return window.enmity.utilities.findInReactTree(o,t,n)}const w=H("utils"),{NativeModules:{DCDChatManager:z}}=g("View","Text","NativeModules"),K=h("FormLabel",{default:!1}),{Text:Y}=g("TextStyleSheet"),{getSettingTitle:G}=g("getSettingTitle"),q=h("SettingsOverviewScreen",{default:!1}),W=g("addFiles","popFirstFile"),Q=g("getNumMediaItemsPerRow"),X=g("getUserProfile"),Z={...l,onStart(){Object.keys(v).forEach(t=>_(t)),w.before(z,"updateRows",(t,n)=>{if(!u("roleDot"))return;const i=JSON.parse(n[1]);for(const a of i)a.type===1&&(a.message.shouldShowRoleDot=!0,a.message.shouldShowRoleOnName=!0);n[1]=JSON.stringify(i)}),w.after(K,"default",(t,n,i)=>{!u("headerPrimary")||(i.props.color="text-normal")});const o=w.after(q,"default",(t,n,i)=>{o();const{sections:a}=J(i,r=>r.sections),y=a.map(r=>r.settings).reduce((r,s)=>[...r,...s],[]).map(r=>G(r));w.before(Y,"render",(r,s)=>{!u("headerPrimary")||s[0].variant==="text-md/semibold"&&s[0].color==="header-primary"&&y.includes(s[0].children)&&(s[0].color="text-normal")})});w.instead(Q,"getNumMediaItemsPerRow",(t,n,i)=>u("mediaItems")?d(l.name,"mediaItemsNumber",2):i.apply(t,n)),w.after(W,"addFiles",(t,n)=>{!u("jsonFix")||n[0].files.forEach(i=>{i.mimeType==="application/json"&&(i.mimeType="text/plain")})}),w.after(X,"getUserProfile",(t,n,i)=>{n[0]!==L.getCurrentUser().id||!u("pronouns")||i.pronouns||(i.pronouns=d(l.name,"pronouns","unspecified"))})},onStop(){w.unpatchAll()},getSettingsPanel(){return m.createElement($,null)}};C(Z);
