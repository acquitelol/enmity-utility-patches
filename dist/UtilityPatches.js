function T(o){window.enmity.plugins.registerPlugin(o)}const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList,e.Image,e.ImageBackground,e.KeyboardAvoidingView,e.Modal,e.Pressable,e.RefreshControl;const N=e.ScrollView;e.SectionList,e.StatusBar,e.StyleSheet,e.Switch,e.Text,e.TextInput,e.TouchableHighlight,e.TouchableOpacity,e.TouchableWithoutFeedback,e.Touchable;const v=e.View;e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox;const x=e.FormDivider;e.FormHint,e.FormIcon;const P=e.FormInput;e.FormLabel,e.FormRadio;const f=e.FormRow,C=e.FormSection;e.FormSelect,e.FormSubLabel;const I=e.FormSwitch;e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;const R=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const s=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings;const D=window.enmity.modules.common.Users;window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack;const F=window.enmity.modules.common.Theme;window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;const d={byProps:(...o)=>window.enmity.modules.filters.byProps(...o),byName:(o,t)=>window.enmity.modules.filters.byName(o,t),byTypeName:(o,t)=>window.enmity.modules.filters.byTypeName(o,t),byDisplayName:(o,t)=>window.enmity.modules.filters.byDisplayName(o,t)};function E(o,t){return window.enmity.modules.getModule(o,t)}function M(...o){return window.enmity.modules.bulk(...o)}function L(...o){return window.enmity.modules.getByProps(...o)}function k(...o){return window.enmity.modules.getByName(...o)}window.enmity.modules.common;var A="UtilityPatches",B="1.1.6",V="Minor patches/fixes all bundled into a single plugin for convenience.",O="#ff0069",_=[{name:"Rosie<3",id:"581573474296791211"}],p={name:A,version:B,description:V,color:O,authors:_};function U(o,t,n){window.enmity.settings.set(o,t,n)}function j(o,t,n){return window.enmity.settings.get(o,t,n)}const r=(o,t)=>j(p.name,o,t),g=(o,t)=>U(p.name,o,t),H={roleDot:{title:"Add Role Dots",subtitle:"Force-enables role-dots aswell as role-colors disregarding your accessibility settings.",icon:"ic_members"},headerPrimary:{title:"Fix Text Labels",subtitle:"Forces all Text Labels use the 'text-normal' color instead of the default 'header-primary'.",icon:"ic_add_text"},earlyPronouns:{title:"Early Pronouns",subtitle:()=>`Set your own pronouns to ${r("pronouns","")} early. Keep in mind others will not be able to see this.`,icon:"ic_accessibility_24px",custom:o=>s.createElement(P,{placeholder:"Your pronouns go here",title:"Pronouns",value:r("pronouns",""),onChange:t=>g("pronouns",t),disabled:o,style:{marginTop:-16}})},mediaItems:{title:"Media Items",subtitle:()=>`Changes the amount of media items per row in media picker to '${r("mediaItemsNumber",2)}' instead of the default '3'.`,icon:"ic_image",custom:o=>{const t=E(u=>u.render.name==="SliderComponent"),n=k("FormLabel"),{meta:{resolveSemanticColor:i}}=L("colors","meta"),{ThemeColorMap:{HEADER_PRIMARY:a,BACKGROUND_PRIMARY:w}}=R,m=u=>s.createElement(n,{text:u,style:{marginHorizontal:24,opacity:o?.5:1}}),l=1,y=8;return s.createElement(v,{style:{alignItems:"center",flexDirection:"row"}},m(l),s.createElement(t,{value:r("mediaItemsNumber",2),minimumValue:l,maximumValue:y,style:{flex:1},minimumTrackTintColor:i(F.theme,a),maximumTrackTintColor:i(F.theme,w),step:1,onValueChange:u=>g("mediaItemsNumber",u),disabled:o,tapToSeek:!0}),m(y))}},jsonFix:{title:"Upload JSON Files",subtitle:"Fixes a long-lasting bug of Discord where JSON files couldn't be uploaded and sent properly.",icon:"icon-qs-files"}};function J(o){return window.enmity.assets.getIDByName(o)}var $=()=>s.createElement(N,null,s.createElement(C,{title:"Preferences"},Object.entries(H).map(([o,t],n,i)=>{var a;const{title:w,subtitle:m,icon:l,custom:y}=t,[u,S]=s.useState(r(o,!0)),b=!r(o,!0);return s.createElement(s.Fragment,null,s.createElement(f,{label:w,subLabel:typeof m=="function"?m==null?void 0:m():m,leading:l&&s.createElement(f.Icon,{source:J(l)}),trailing:()=>s.createElement(I,{value:u,onValueChange:h=>(g(o,h),S(h))}),disabled:b}),(a=y==null?void 0:y(b))!=null?a:s.createElement(s.Fragment,null),n<i.length-1&&s.createElement(x,null))})));function z(o){return window.enmity.patcher.create(o)}function K(o,t,n){return window.enmity.utilities.findInReactTree(o,t,n)}const c=z("utils"),[{NativeModules:{DCDChatManager:Y}},G,{Text:q},{getSettingTitle:W},Q,X,Z,ee]=M(d.byProps("View","Text","NativeModules"),d.byName("FormLabel",!1),d.byProps("TextStyleSheet"),d.byProps("getSettingTitle"),d.byName("SettingsOverviewScreen",!1),d.byProps("getUserProfile"),d.byProps("getNumMediaItemsPerRow"),d.byProps("addFiles","popFirstFile")),oe={...p,onStart(){c.before(Y,"updateRows",(t,n)=>{if(!r("roleDot"))return;const i=JSON.parse(n[1]);for(const a of i)a.type===1&&(a.message.shouldShowRoleDot=!0,a.message.shouldShowRoleOnName=!0);n[1]=JSON.stringify(i)}),c.after(G,"default",(t,n,i)=>{!r("headerPrimary")||(i.props.color="text-normal")});const o=c.after(Q,"default",(t,n,i)=>{o();const{sections:a}=K(i,m=>m.sections),w=a.map(m=>m.settings).reduce((m,l)=>[...m,...l],[]).map(m=>W(m));c.before(q,"render",(m,l)=>{!r("headerPrimary")||l[0].variant==="text-md/semibold"&&l[0].color==="header-primary"&&w.includes(l[0].children)&&(l[0].color="text-normal")})});c.after(X,"getUserProfile",(t,n,i)=>{n[0]!==D.getCurrentUser().id||!r("pronouns","")||i.pronouns||(i.pronouns=r("pronouns",""))}),c.instead(Z,"getNumMediaItemsPerRow",(t,n,i)=>r("mediaItems")?r("mediaItemsNumber",2):i.apply(t,n)),c.after(ee,"addFiles",(t,n)=>{!r("jsonFix")||n[0].files.forEach(i=>{i.mimeType==="application/json"&&(i.mimeType="text/plain")})})},onStop(){c.unpatchAll()},getSettingsPanel(){return s.createElement($,null)}};T(oe);
